{"ast":null,"code":"import axios from 'axios';\nexport default {\n  //to filter public, institution & foreigner\n  async loadPrice({\n    rootGetters,\n    commit\n  }) {\n    try {\n      const url = rootGetters.getUrl;\n      const response = await axios.get(`${url}/api/details/loadPrice`);\n      if (response.status === 200) {\n        const ctg = response.data;\n        console.log(ctg);\n        const categorizedData = {};\n        ctg.forEach(item => {\n          if (!categorizedData[item.category]) {\n            categorizedData[item.category] = {};\n          }\n          categorizedData[item.category][item.type] = item.price;\n        });\n        console.log(categorizedData);\n        commit('setPricing', categorizedData);\n        const tax = ctg.filter(ticket => ticket.category === 'tax');\n        commit('setTax', tax);\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  },\n  //to validate mobile and generate otp\n  async generateOtp({\n    rootGetters,\n    commit\n  }, payload) {\n    try {\n      const url = rootGetters.getUrl;\n      const response = await axios.post(`${url}/api/2factor/generate-otp`, {\n        \"mobileNumber\": payload\n      });\n      if (response.status === 200) {\n        const messag = JSON.parse(response.data.message);\n        commit('setMobile', response.data.mobileNumber);\n        commit('setSession', messag);\n        console.log('session', rootGetters.getsession);\n        return true;\n      }\n    } catch (err) {\n      console.log(err);\n      throw Error(err.response ? err.response.data : err.message);\n    }\n  },\n  //validate otp\n  async verifyOtp({\n    rootGetters\n  }, payload) {\n    try {\n      const url = rootGetters.getUrl;\n      const response = await axios.post(`${url}/api/2factor/validate-otp`, {\n        \"enteredOtp\": payload.otp,\n        \"sessionId\": rootGetters.getsession.Details,\n        \"mobileNumber\": payload.mobile\n      });\n      if (response.status === 200) {\n        return true;\n      }\n    } catch (error) {\n      console.log(error);\n      if (error.response.data) {\n        throw error.response.data.message;\n      } else throw error.response.message;\n    }\n  },\n  //get holiday\n  async getHoliday({\n    rootGetters\n  }) {\n    const response = await axios.get(`${rootGetters.getUrl}/api/holidays/getDayList`);\n    if (response.status === 200) {\n      const dates = response.data.map(item => item.date);\n      console.log(dates);\n      return dates;\n    }\n  },\n  //get all slots \n  async getSlots({\n    rootGetters,\n    commit\n  }) {\n    try {\n      const url = rootGetters.getUrl;\n      const response = await axios.get(`${url}/api/stime/getSlot`);\n      if (response.status === 200) {\n        const filteredIds = response.data.filter(obj => obj.status === true).map(obj => obj.id);\n        commit('setSlots', filteredIds);\n        return true;\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  },\n  //get slots by date\n  async getSlotDate({\n    rootGetters,\n    commit\n  }, payload) {\n    try {\n      const ids = rootGetters.getSlots.join(',');\n      console.log('ids', ids);\n      console.log('date clicked for slot');\n      const response = await axios.get(`${rootGetters.getUrl}/api/calEve/eventCal?date=${payload}&slotIds=${ids}`);\n      if (response.status === 200) {\n        console.log('response from backend fore selected date', response.data);\n        const data = response.data.sort((a, b) => a.id - b.id);\n        commit('setSelectedSlot', data);\n        return data;\n      }\n    } catch (error) {\n      console.log(error);\n      throw error.message;\n    }\n  },\n  //lock slot\n  async lockSlot({\n    rootGetters,\n    commit\n  }, payload) {\n    const res = await axios.get(`${rootGetters.getUrl}/api/booking/lock?capacity=${payload.capacity}&visitDate=${payload.date}&slotName=${payload.slot}&category=${payload.cat}`);\n    if (res.status === 200) {\n      commit('setCapacityId', res.data);\n      return true;\n    }\n  },\n  //submit details\n  async submitDetails({\n    rootGetters\n  }, payload) {\n    try {\n      const url = rootGetters.getUrl;\n      const response = await axios.post(`${url}/api/details/submit`, payload);\n      if (response.status === 200) {\n        console.log('submitted', response.data);\n        const result = {\n          amount: response.data.totalPrice,\n          id: response.data.uniqueId\n        };\n        console.log('result', result);\n        return result;\n      }\n    } catch (error) {\n      throw Error(error);\n    }\n  },\n  //create orderid with razorpay\n  async createOrder({\n    rootGetters,\n    commit\n  }, payload) {\n    try {\n      const url = rootGetters.getUrl;\n      const response = await axios.post(`${url}/api/payment/create-order`, payload);\n      if (response.status === 200) {\n        console.log(response.data);\n        commit('setRazor', response.data);\n        return true;\n      }\n    } catch (error) {\n      console.log(error);\n      throw Error(error);\n    }\n  }\n};","map":{"version":3,"names":["axios","loadPrice","rootGetters","commit","url","getUrl","response","get","status","ctg","data","console","log","categorizedData","forEach","item","category","type","price","tax","filter","ticket","error","generateOtp","payload","post","messag","JSON","parse","message","mobileNumber","getsession","err","Error","verifyOtp","otp","Details","mobile","getHoliday","dates","map","date","getSlots","filteredIds","obj","id","getSlotDate","ids","join","sort","a","b","lockSlot","res","capacity","slot","cat","submitDetails","result","amount","totalPrice","uniqueId","createOrder"],"sources":["D:/Documents/ticket-booking/Museum-completed/src/store/actions.js"],"sourcesContent":["import axios from 'axios';\r\nexport default {\r\n    //to filter public, institution & foreigner\r\n    async loadPrice({ rootGetters, commit }) {\r\n        try {\r\n            const url = rootGetters.getUrl;\r\n            const response = await axios.get(`${url}/api/details/loadPrice`);\r\n            if (response.status === 200) {\r\n              const ctg = response.data;\r\n              console.log(ctg)\r\n              const categorizedData = {};\r\n              ctg.forEach(item => {\r\n              if (!categorizedData[item.category]) {\r\n                categorizedData[item.category] = {};\r\n              }\r\n              categorizedData[item.category][item.type] = item.price;\r\n            });\r\n              console.log(categorizedData);\r\n                commit('setPricing', categorizedData);\r\n              const tax = ctg.filter(ticket => ticket.category === 'tax');\r\n              \r\n                commit('setTax', tax)\r\n            }\r\n        }\r\n        catch (error) {\r\n            console.error(error)\r\n        }\r\n    },\r\n    //to validate mobile and generate otp\r\n    async generateOtp({ rootGetters, commit }, payload) {\r\n        try {\r\n          const url = rootGetters.getUrl;\r\n          const response = await axios.post(`${url}/api/2factor/generate-otp`, {\r\n              \"mobileNumber\": payload,\r\n          });\r\n          if (response.status === 200) {\r\n              const messag = JSON.parse(response.data.message);\r\n              commit('setMobile', response.data.mobileNumber);\r\n            commit('setSession', messag);\r\n            console.log('session', rootGetters.getsession)\r\n              return true;\r\n          }\r\n        }\r\n        catch (err) {\r\n          console.log(err)\r\n           throw Error(err.response? err.response.data : err.message);\r\n        }\r\n    },\r\n    //validate otp\r\n    async verifyOtp({rootGetters}, payload) {\r\n      try {\r\n        const url = rootGetters.getUrl;\r\n        const response = await axios.post(`${url}/api/2factor/validate-otp`, {\r\n          \"enteredOtp\": payload.otp,\r\n          \"sessionId\": rootGetters.getsession.Details,\r\n          \"mobileNumber\": payload.mobile\r\n        });\r\n        if (response.status === 200) {\r\n           return true;\r\n        }\r\n      }\r\n      catch (error) {\r\n        console.log(error)\r\n        if (error.response.data) {\r\n          throw (error.response.data.message);\r\n        }\r\n        else throw (error.response.message)\r\n        \r\n      }\r\n  },\r\n     //get holiday\r\n    async getHoliday({ rootGetters}) {\r\n    const response = await axios.get(`${rootGetters.getUrl}/api/holidays/getDayList`);\r\n      if (response.status === 200) {\r\n        const dates = response.data.map(item => item.date)\r\n        console.log(dates)\r\n      return dates;\r\n    }\r\n  },\r\n  //get all slots \r\n  async getSlots({ rootGetters, commit }) {\r\n      try {\r\n        const url = rootGetters.getUrl;\r\n        const response = await axios.get(`${url}/api/stime/getSlot`);\r\n        if (response.status === 200) {\r\n           const filteredIds = response.data\r\n            .filter(obj => obj.status === true)\r\n            .map(obj => obj.id);\r\n          commit('setSlots', filteredIds);\r\n          return true;\r\n        }\r\n      }\r\n      catch (error) {\r\n        console.log(error);\r\n        \r\n      }\r\n  },\r\n  //get slots by date\r\n  async getSlotDate({ rootGetters, commit }, payload) {\r\n    try\r\n    {\r\n      const ids = rootGetters.getSlots.join(',');\r\n      console.log('ids', ids)\r\n        console.log('date clicked for slot')\r\n        const response = await axios.get(`${rootGetters.getUrl}/api/calEve/eventCal?date=${payload}&slotIds=${ids}`);\r\n        if (response.status === 200) {\r\n          console.log('response from backend fore selected date',response.data);\r\n          const data = response.data.sort((a, b) => a.id - b.id);\r\n          commit('setSelectedSlot', data)\r\n          return data;\r\n        }\r\n      }\r\n    catch (error) {\r\n      console.log(error)\r\n        throw error.message\r\n      }\r\n  },\r\n  //lock slot\r\n  async lockSlot({ rootGetters,commit}, payload) {\r\n      const res = await axios.get(`${rootGetters.getUrl}/api/booking/lock?capacity=${payload.capacity}&visitDate=${payload.date}&slotName=${payload.slot}&category=${payload.cat}`)\r\n        if (res.status === 200) {\r\n          commit('setCapacityId', res.data);\r\n          return true;\r\n        }\r\n  },\r\n  //submit details\r\n  async submitDetails({  rootGetters }, payload) {\r\n    try {\r\n     const url = rootGetters.getUrl;\r\n     const response = await axios.post(`${url}/api/details/submit`, payload);\r\n      if (response.status === 200) {\r\n        \r\n        console.log('submitted',response.data)\r\n        const result = {\r\n          amount: response.data.totalPrice,\r\n          id: response.data.uniqueId\r\n        };\r\n        console.log('result', result)\r\n      return result;\r\n     }\r\n    } \r\n    catch (error) {\r\n      throw Error(error);\r\n    }\r\n  },\r\n  //create orderid with razorpay\r\n  async createOrder({ rootGetters, commit }, payload) {\r\n    try {\r\n     const url = rootGetters.getUrl;\r\n     const response = await axios.post(`${url}/api/payment/create-order`, payload);\r\n      if (response.status === 200) {\r\n       \r\n        console.log(response.data)\r\n        commit('setRazor', response.data)\r\n        return true;\r\n      }\r\n    } \r\n    catch (error) {\r\n      console.log(error)\r\n      throw Error(error);\r\n    }\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}